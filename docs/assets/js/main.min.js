let MAX_PIZZA=10;function formatUtils(){return{formatPrice(e,t="en-US",a=2,i=2){return new Intl.NumberFormat(t,{minimumFractionDigits:a,maximumFractionDigits:i}).format(e)}}}function storageUtils(){return{saveCart(e){localStorage.setItem("cart",JSON.stringify(e))}}}function domUtils(){return{clearContainer(e){e.innerHTML=""},lockScroll(){var e=window.innerWidth-document.documentElement.clientWidth;document.body.style.paddingRight=e+"px",document.documentElement.classList.add("no-scroll"),document.body.classList.add("no-scroll")},unlockScroll(){document.body.style.paddingRight="",document.documentElement.classList.remove("no-scroll"),document.body.classList.remove("no-scroll")},hiddenText(e,t){var a=e.textContent;a.length>t&&(e.textContent=a.slice(0,t)+"...")},removeClassFromAll({selector:e=null,className:t,arrElements:a=null}){let i=[];null!==e?i=document.querySelectorAll(e):null!==a&&(i=a),i.length&&i.forEach(e=>e.classList.remove(t))},addClassToAll({selector:e=null,className:t,arrElements:a=null}){let i=[];null!==e?i=document.querySelectorAll(e):null!==a&&(i=a),i.length&&i.forEach(e=>e.classList.add(t))}}}function renderUtils(){return{renderCard(e,t=null){var a=e.ingredients.slice(0,3).join(", "),i=e.ingredients.slice(3).join(", ");let n=Object.values(e.price)[0];t&&(n=t(n));t=Object.entries(e.price).map(([e,t],a)=>`
      <label class="pizza-card__size-label">
        <input class="pizza-card__size-radio visually-hidden" 
               data-price="${t}" 
               type="radio" 
               name="size" 
               value="${e}" 
               ${0===a?"checked":""} />
        <span class="pizza-card__size-text">${e}</span>
      </label>
    `).join("");return`
    <article data-id="${e.id}" class="pizza-card">
      <header class="pizza-card__header">
        <figure class="pizza-card__figure">
          <img class="pizza-card__img" src="./assets/img/pizza/${e.image}.webp" alt="${e.namePizza}" />
        </figure>
        <h3 class="pizza-card__title">${e.namePizza}</h3>
      </header>
      <div class="pizza-card__ingredients">
        <p class="pizza-card__first-line text-ellipsis w-17vw">
          Filling: ${a}${i?",":""}
        </p>
        ${i?`
          <p class="pizza-card__second-line text-ellipsis">
            ${i}
          </p>
        `:""}
      </div>
      <form class="pizza-card__form">
        <fieldset class="pizza-card__fieldset">
          <legend class="visually-hidden">Select pizza size</legend>
            ${t}
        </fieldset>
      </form>
    
      <button aria-expanded="false" aria-haspopup="dialog" aria-label="Customize ingredients for ${e.namePizza}" class="pizza-card__customize-btn">
        <span class="text-gradient ps-rel-idx-100">+ Ingredients</span>
      </button>
      <div class="pizza-card__order-controls">
        <p class="pizza-card__price text-ellipsis">
          <span class="total-price">${n}</span>
          <span class="pizza-card__currency">$</span>
        </p>
        <div class="pizza-card__quantity-controls">
          <button aria-label="Decrease quantity" disabled class="pizza-card__quantity-btn decrement-quantity">
            <svg width="8" height="2" viewBox="0 0 12 2">
              <path d="M0 1H12" stroke="currentColor" stroke-width="2" />
            </svg>
          </button>
          <p aria-live="polite" class="pizza-card__quantity quantity">1</p>
          <button aria-label="Increase quantity" class="pizza-card__quantity-btn pizza-card__quantity-btn--active increment-quantity">
            <svg width="8" height="8" viewBox="0 0 12 12">
              <path d="M0 6H12M6 0V12" stroke="currentColor" stroke-width="2" />
            </svg>
          </button>
        </div>
      </div>
      <button aria-label="Order ${e.namePizza} now" class="pizza-card__order btn btn--accent btn--small">
        Order Now
      </button>
    </article>
  `},renderAllCards(e,t=null){return e.map(e=>this.renderCard(e,t))},renderCardsIngredients(e,t=1){let a="";return e.forEach(e=>{a+=`
          <li tabindex="0" role="checkbox" aria-checked="false" class="panel-ingredients__value" data-id="${e.id}">
          <p class="panel-ingredients__price" aria-label="Ingredient price">${(e.price*t).toFixed(2)} $</p>
            <figure class="ingredient-card">
              <div class="ingredient-card__wrapper-img">
                <img src="./assets/img/ingredients/${e.nameImg}.png" alt="image ingredient ${e.name}" class="ingredient-card__img" />
              </div>
              <figcaption class="ingredient-card__title">${e.name}</figcaption>
            </figure>
          </li>
        `}),a},renderTextIngredients(e,t=""){return e.length?e.map(e=>`<span>${e}</span>`).join(", "):`<span>${t}</span>`},renderPanelAddIngredients(e,t){let a="";Object.entries(e).forEach(([e,t])=>{a+=`
            <section class="panel-ingredients__section">
              <h4 class="panel-ingredients__title panel-ingredients__title--small">${e}</h4>
              <ul class="panel-ingredients__container-ingredients">${t}</ul>
            </section>
        `}),t.innerHTML=` <h3 class="panel-ingredients__title panel-ingredients__overlay">Add ingredient</h3><div class="panel-ingredients__wrapper-sections">${a}</div>`},renderPanelInfoPizza({pizzaData:e,sizePizza:t,pizzaQuantity:a,container:i,callbackFormat:n=null}){let r=e.price[t],s=e.price[t]*a;n&&(r=n(r),s=n(s));n=`
      <header class="panel-pizza__header">
        <h3 class="panel-pizza__title">${e.namePizza}</h3>
        <p aria-label="Pizza size" class="panel-pizza__size">X ${t}</p>
      </header>

      <div class="panel-pizza__info-container">
        <div class="panel-pizza__img">
          <img src="./assets/img/pizza/${e.image}.png" alt="${e.namePizza}">
         </div>
        <div class="panel-pizza__info">
          <p class="panel-pizza__description">${e.description}</p>
          <p class="panel-pizza__price-custom">Your pizza: <span class="custom-price-one"> ${r}</span> $</p>
          <p class="panel-pizza__price-standard">Standard price: ${r} $</p>
        </div>
      </div>
  
      <p class="panel-pizza__ingredients"><span class="fw-500">Ingredients:</span> ${this.renderTextIngredients(e.ingredients)}</p>
      <p class="panel-pizza__ingredients"><span class="fw-500">Extra Ingredients:</span> <span id="custom-ingredients">-</span></p>

        <div class="panel-pizza__footer">
          <div class="panel-pizza__quantity-controls">
            <button aria-label="Decrease quantity" class="panel-pizza__btn-quantity decrement-quantity">-</button>
            <span aria-live="polite" class="panel-pizza__quantity quantity">${a}</span>
            <button aria-label="Increase quantity" class="panel-pizza__btn-quantity  increment-quantity">+</button>
          </div>
          <p class="panel-pizza__price-total">Total <span class="total-price">${s}</span> $</p>
        </div>
      `;i.innerHTML=n},renderCartItem(e){var t=e[1].pizzaQuantity<=1?"disabled":"";let a=[];return e[1].addedIngredients.length&&(a=e[1].addedIngredients.map(e=>e.name)),`
      <article class="cart-item" data-id="${e[0]}">
      <img src="./assets/img/pizza/${e[1].image}.webp" alt="${e[1].namePizza} size ${e[1].sizePizza}" class="cart-item__img" />
      <div class="cart-item__info">
        <h3 class="cart-item__name">${e[1].namePizza}</h3>
        <p class="cart-item__size">X ${e[1].sizePizza}</p>
        <p class="cart-item__price">
          <span class="cart-item-price">${e[1].totalPrice.toFixed(2)}</span> $
        </p>
        <section class="cart-item__custom-ingredients">
          <h3 class="cart-item__title-ingredients">Extra ingredients:</h3>
          <p class="cart-item__addons">
          ${this.renderTextIngredients(a,"no additional ingredients")}
          </p>
        </section>
      </div>
      <div class="cart-item__controls">
        <button class="cart-item__btn cart-item__btn--minus decrement-quantity" aria-label="Reduce quantity" ${t}>
          âˆ’
        </button>
        <span class="cart-item__quantity" aria-live="polite">${e[1].pizzaQuantity}</span>
        <button class="cart-item__btn cart-item__btn--plus increment-quantity" aria-label="Increase quantity">
          +
        </button>
      </div>
      <button class="cart-item__btn cart-item__remove" aria-label="Delete ${e[1].pizzaQuantity} ${e[1].namePizza}"></button>
    </article>
      `}}}function dataUtils(){return{normalizePizzaIngredients(e,i){for(var t in e)Object.hasOwnProperty.call(e,t)&&e[t].forEach(e=>{let a=[];e.ingredients.forEach(t=>{var e=i.find(e=>e.id===t);a.push(e.name)}),e.ingredients=a});return e},deepClone(e){if(!(e instanceof Object))return e;var t,a,i={};for(t in e)Object.hasOwnProperty.call(e,t)&&(a=e[t],e[t]instanceof Object&&!(e[t]instanceof Array)?i[t]=this.deepClone(a):e[t]instanceof Array?i[t]=a.map(e=>this.deepClone(e)):i[t]=e[t]);return i}}}function pizzaUtils(){return{getPizzaId(e){return+e.getAttribute("data-id")},resetPizzaCard({pizzaCardElem:e,sizeValue:t=22,pizzaQuantity:a=1,callbackFormat:i=null}){e.querySelector(".quantity").textContent=a;var n=e.querySelector(".increment-quantity"),r=e.querySelector(".decrement-quantity"),t=e.querySelector(`input[name="size"][value="${t}"]`),e=e.querySelector(".total-price"),s=t.getAttribute("data-price");e.textContent=i?i(a*s):a*s,t.checked=!0,n.disabled=!1,r.disabled=!0},getPizzaSize(e){return+e.querySelector('input[name="size"]:checked').value},getPricePerPizza(e){return+e.querySelector('input[name="size"]:checked').getAttribute("data-price")},getPizzaQuantity(e){return+e.querySelector(".quantity").textContent},setPizzaQuantity({parentElement:e,quantity:t,selector:a,min:i=1,max:n=MAX_PIZZA}){n<t?t=n:t<i&&(t=i),e.querySelector(a).textContent=t},setPricePizza({parentElement:e,price:t,selector:a}){e=e.querySelector(a);e&&(e.textContent=t)},updateBtn({parentElement:e,pizzaQuantity:t,min:a=1,max:i=MAX_PIZZA}){var n=e.querySelector(".decrement-quantity"),e=e.querySelector(".increment-quantity");n.disabled=t<=a,e.disabled=i<=t}}}function cartUtils(){return{updateCartItemCount({targetElement:e,quantity:t,activeClass:a}){t<1?(e.classList.remove(a),e.textContent=0):(t=99<t?"99+":t,e.classList.add(a),e.textContent=t)},getQuantity({cart:e,propertyQuantity:a}){return Object.values(e).reduce((e,t)=>e+=t[a],0)},calculateItemTotalPrice({cart:e,idCartItem:t}){e[t].totalPrice=e[t].pricePerPizza*e[t].pizzaQuantity},sumCartItemsPrice({cart:e}){return Object.values(e).reduce((e,t)=>e+t.totalPrice,0)}}}function getIngredients(){return{cheeses:[{id:1,name:"extra cheese",price:1,nameImg:"extra-cheese"},{id:2,name:"gorgonzola",price:2,nameImg:"gorgonzola"},{id:3,name:"parmesan",price:1.8,nameImg:"parmesan"},{id:4,name:"mozzarella",price:1.2,nameImg:"mozzarella"},{id:5,name:"ricotta",price:1.7,nameImg:"ricotta"}],vegetables:[{id:6,name:"mushrooms",price:1,nameImg:"mushrooms"},{id:7,name:"olives",price:.8,nameImg:"olives"},{id:8,name:"bell peppers",price:1,nameImg:"bell-peppers"},{id:9,name:"onions",price:.5,nameImg:"onions"},{id:10,name:"fresh tomatoes",price:.9,nameImg:"fresh-tomatoes"},{id:11,name:"spinach",price:1.3,nameImg:"spinach"},{id:12,name:"red onions",price:.6,nameImg:"red-onions"},{id:13,name:"sun-dried tomatoes",price:1.5,nameImg:"sun-dried-tomatoes"},{id:14,name:"basil",price:.2,nameImg:"basil"},{id:28,name:"sweet corn",price:1,nameImg:"sweet-corn"}],meats:[{id:15,name:"beef",price:2.5,nameImg:"beef"},{id:16,name:"ham",price:1.8,nameImg:"ham"},{id:17,name:"pepperoni",price:2.2,nameImg:"pepperoni"},{id:18,name:"bacon",price:2,nameImg:"bacon"},{id:19,name:"chicken",price:2,nameImg:"chicken"},{id:20,name:"salami",price:2.2,nameImg:"salami"},{id:21,name:"italian sausages",price:2.5,nameImg:"italian-sausages"},{id:22,name:"prosciutto",price:2.5,nameImg:"prosciutto"}],seafood:[{id:23,name:"shrimps",price:2.5,nameImg:"shrimps"},{id:24,name:"squid",price:3,nameImg:"squid"},{id:25,name:"mussels",price:2.8,nameImg:"mussels"},{id:26,name:"smoked salmon",price:3.5,nameImg:"smoked-salmon"},{id:27,name:"tuna",price:2.5,nameImg:"tuna"}],sauces:[{id:30,name:"tomato sauce",price:.5,nameImg:"tomato-sauce"},{id:31,name:"BBQ sauce",price:.8,nameImg:"BBQ-sauce"},{id:32,name:"creamy sauce",price:1.5,nameImg:"creamy-sauce"},{id:33,name:"white sauce",price:1.2,nameImg:"white-sauce"},{id:34,name:"cream sauce",price:1.3,nameImg:"cream-sauce"}],special:[{id:35,name:"truffle oil",price:2.5,nameImg:"truffle-oil"},{id:36,name:"oregano",price:.3,nameImg:"oregano"},{id:37,name:"thyme",price:.4,nameImg:"thyme"},{id:38,name:"dill",price:.4,nameImg:"dill"},{id:39,name:"garlic",price:.5,nameImg:"garlic"},{id:29,name:"capers",price:1,nameImg:"capers"}]}}function getPizzaData(){return{meat:[{id:1,namePizza:"Meat",description:"Assortment of beef, ham, pepperoni and bacon",price:{22:12,28:16,33:20},image:"meat-pizza",ingredients:[15,16,17,18,4,30]},{id:2,namePizza:"Argentina",description:"Juicy Argentinian beef with herbs",price:{22:13,28:17,33:21},image:"argentina-pizza",ingredients:[15,37,9,8,4,30]},{id:3,namePizza:"Venecia",description:"Venetian style with Italian sausages",price:{22:12,28:16,33:20},image:"venecia-pizza",ingredients:[21,7,9,8,4]},{id:4,namePizza:"Pepperoni Classic",description:"Double pepperoni with extra cheese",price:{22:11,28:15,33:19},image:"meat-pizza",ingredients:[17,4,30,36]},{id:5,namePizza:"BBQ Chicken",description:"Grilled chicken with BBQ sauce",price:{22:12,28:16,33:20},image:"meat-pizza",ingredients:[19,31,12,4,28]}],vegetarian:[{id:6,namePizza:"Cheese",description:"Mozzarella, gorgonzola, parmesan and ricotta",price:{22:10,28:14,33:18},image:"cheese-pizza",ingredients:[4,2,3,5,30]},{id:7,namePizza:"Tomato",description:"Classic with fresh tomatoes and basil",price:{22:9,28:13,33:17},image:"tomato-pizza",ingredients:[10,14,4,30]},{id:8,namePizza:"Italian",description:"Traditional Italian recipe",price:{22:8.35,28:15.33,33:19.6},image:"italian-pizza",ingredients:[22,8,3,4,30]},{id:9,namePizza:"Italian x2",description:"Double portion of Italian ingredients",price:{22:13,28:17,33:21},image:"italian-x2-pizza",ingredients:[22,20,7,4,30]},{id:10,namePizza:"Vegetarian",description:"Fresh vegetables and herbs",price:{22:11,28:15,33:19},image:"tomato-pizza",ingredients:[8,10,9,7,6,4]},{id:11,namePizza:"Mediterranean",description:"Sun-dried tomatoes, olives and feta cheese",price:{22:12,28:16,33:20},image:"meat-pizza",ingredients:[13,7,2,11,4]}],mushroom:[{id:12,namePizza:"Gribnaya",description:"Assorted mushrooms with creamy sauce",price:{22:10,28:14,33:18},image:"mushroom-pizza",ingredients:[22,23,24,4,25]},{id:13,namePizza:"Forest Mushroom",description:"Wild forest mushrooms with herbs",price:{22:11,28:15,33:19},image:"argentina-pizza",ingredients:[26,37,39,4,28]},{id:14,namePizza:"Truffle Mushroom",description:"Mushrooms with truffle oil",price:{22:13,28:17,33:21},image:"mushroom-pizza",ingredients:[6,29,3,4,28]}],sea_products:[{id:15,namePizza:"Seafood Mix",description:"Shrimps, squid and mussels",price:{22:14,28:18,33:22},image:"argentina-pizza",ingredients:[23,24,25,39,4,33]},{id:16,namePizza:"Tuna & Corn",description:"Tuna with sweet corn and onions",price:{22:12,28:16,33:20},image:"venecia-pizza",ingredients:[27,28,12,4,30]},{id:17,namePizza:"Salmon Supreme",description:"Smoked salmon with cream cheese",price:{22:15,28:19,33:23},image:"cheese-pizza",ingredients:[26,5,29,12,38]}]}}function initHeaderListUi(e){let a=document.querySelectorAll(".header .link-nav"),i=!1;a.forEach(e=>{e.addEventListener("click",e=>{i=!0,n(e.target),setTimeout(()=>{i=!1},500)})});let t=new IntersectionObserver(e=>{e.forEach(e=>{var t;i||({isIntersecting:e,target:t}=e,e&&(e=+t.getAttribute("data-index"),n(a[e])))})},{threshold:0,rootMargin:"-50% 0px -50% 0px"});function n(e){e&&(a.forEach(e=>e.classList.remove("link-nav--active")),e.classList.add("link-nav--active"))}e.forEach(e=>{t.observe(e)})}function initSwitchHero(e){let t={$target:document.getElementById("switch"),class_1:"switch--toggle-left",class_2:"switch--toggle-right",switchLeft(){this.$target.classList.remove(this.class_2),this.$target.classList.add(this.class_1)},switchRight(){this.$target.classList.remove(this.class_1),this.$target.classList.add(this.class_2)}};t.$target.addEventListener("click",e=>{e.currentTarget&&t.switchRight()});new IntersectionObserver(e=>{e.forEach(e=>{e=e.isIntersecting;e?t.switchRight():t.switchLeft()})},{threshold:0,rootMargin:"0px 0px -200px 0px"}).observe(e)}function initVideoPromo(a,e){let i=document.querySelector(".promo__title"),n={$video:e,playVideo(){this.$video.play().catch(e=>{console.log("ÐÐ²Ñ‚Ð¾Ð²Ð¾ÑÐ¿Ñ€Ð¾Ð¸Ð·Ð²ÐµÐ´ÐµÐ½Ð¸Ðµ Ð·Ð°Ð±Ð»Ð¾ÐºÐ¸Ñ€Ð¾Ð²Ð°Ð½Ð¾",e)})},pauseVideo(){this.$video.pause()}};new IntersectionObserver((e,t)=>{e.forEach(e=>{e.isIntersecting&&(n.playVideo(),i.classList.remove("promo__title--hidden"),t.unobserve(a))})},{threshold:.3,rootMargin:"0px 0px -100px 0px"}).observe(a)}function initFooter(e){var t=document.getElementById("footer-link-all"),a=document.getElementById("footer-link-meat"),i=document.getElementById("footer-link-sea"),n=document.getElementById("footer-link-vegan"),r=document.getElementById("footer-link-mushrooms"),s=document.getElementById("all"),c=document.getElementById("meat"),l=document.getElementById("vegetarian"),o=document.getElementById("sea_products"),d=document.getElementById("mushroom");let z=new Map;z.set(t,s),z.set(a,c),z.set(i,o),z.set(n,l),z.set(r,d),e.addEventListener("click",e=>{z.get(e.target)&&z.get(e.target).click()})}console.log(MAX_PIZZA,"MAX PIZZA");let utilsFormat=formatUtils(),utilsStorage=storageUtils(),utilsDOM=domUtils(),utilsRender=renderUtils(),utilsData=dataUtils(),utilsPizza=pizzaUtils(),utilsCart=cartUtils(),ingredients=getIngredients(),flatIngredients=Object.values(ingredients).flat(),pizzaProducts=utilsData.normalizePizzaIngredients(getPizzaData(),flatIngredients),flatPizzaProducts=Object.values(pizzaProducts).flat(),INGR_PRICE_COEFF={22:1,28:1.27,33:1.5},KEY={NO_INGREDIENTS:"no-custom-ingredients",SEPARATOR:"_"},$menuPizza=document.getElementById("menuPizza"),$menuOverlay=document.getElementById("overlay-menu"),$heroPizza=document.getElementById("hero"),$eventsPizza=document.getElementById("events"),$aboutPizza=document.getElementById("about"),$footer=document.getElementById("footer"),$activeCustomizeTrigger=null,$btnCloseCustomPanel=document.getElementById("custom-panel-close"),$videoMenu=document.getElementById("video-promo"),$cartBtn=document.getElementById("cartBtn"),$countCart=document.querySelector(".cart-btn__count"),$tabsContainer=document.getElementById("tabs"),$tabsButtons=document.querySelectorAll(".menu__tab-btn button"),$topContainerCards=document.getElementById("top-cards"),$bottomContainerCards=document.getElementById("bottom-cards"),$staticTopContainerCards=document.getElementById("top-static-cards"),$staticBottomContainerCards=document.getElementById("bottom-static-cards"),$allStaticCards=document.querySelectorAll("#top-static-cards .pizza-card, #bottom-static-cards .pizza-card"),$ingredientsPanel=document.getElementById("panel-ingredients"),$pizzaInfoPanel=document.getElementById("panel-info-pizza"),savedCart=localStorage.getItem("cart"),cart=savedCart?JSON.parse(savedCart):{},popUpPizzaData={},addedIngredients=[];function cleanupPizzaPopup({pizzaCardElem:e,sizeValue:t=22,pizzaQuantity:a=1,callbackFormat:i}){console.log("cleanupPizzaPopup"),utilsDOM.unlockScroll(),utilsDOM.clearContainer($pizzaInfoPanel),utilsDOM.clearContainer($ingredientsPanel),addedIngredients=[],utilsPizza.resetPizzaCard({pizzaCardElem:e,sizeValue:t,pizzaQuantity:a,callbackFormat:i}),utilsPizza.updateBtn({parentElement:e,pizzaQuantity:a}),$activeCustomizeTrigger.setAttribute("aria-expanded",!1),console.log($activeCustomizeTrigger),$activeCustomizeTrigger=null}function addToCart({cart:e,idPizza:t,sizePizza:a,keyIngredients:i,pizzaQuantity:n,pricePerPizza:r,namePizza:s,image:c="",addedIngredients:l=[],separator:o="_"}){e[t+o+a+o+i]?(console.log("ÑƒÐ¶Ðµ ÐµÑÑ‚ÑŒ Ð¿Ð¸Ñ†Ñ†Ð°-ÐºÐ°Ñ€Ñ‚Ð¾Ñ‡ÐºÐ°"),e[t+o+a+o+i].pizzaQuantity+=n,e[t+o+a+o+i].totalPrice=e[t+o+a+o+i].pizzaQuantity*r):(console.log("Ð½Ð¾Ð²Ð°Ñ Ð¿Ð¸Ñ†Ñ†Ð° ÐºÐ°Ñ€Ñ‚Ð¾Ñ‡ÐºÐ°"),e[t+o+a+o+i]={namePizza:s,image:c,pizzaQuantity:n,sizePizza:a,totalPrice:n*r,pricePerPizza:r,addedIngredients:l})}utilsCart.updateCartItemCount({targetElement:$countCart,quantity:utilsCart.getQuantity({cart:cart,propertyQuantity:"pizzaQuantity"}),activeClass:"cart-btn__count--active"}),initHeaderListUi([$menuPizza,$heroPizza,$eventsPizza,$aboutPizza,$footer]),initSwitchHero($menuPizza),initVideoPromo($videoMenu,$videoMenu),initFooter($footer),$tabsContainer.addEventListener("click",e=>{var t,e=e.target.closest("button");e&&(t=e.getAttribute("data-category"),$tabsButtons.forEach(e=>{e.classList.remove("btn--accent");e=e.closest("li");e&&e.classList.remove("menu__tab-btn--active")}),e.classList.add("btn--accent"),(e=e.closest("li"))&&e.classList.add("menu__tab-btn--active"),"all"===t?(utilsDOM.addClassToAll({className:"d-none",arrElements:[$topContainerCards,$bottomContainerCards]}),utilsDOM.removeClassFromAll({className:"d-none",arrElements:[$staticTopContainerCards,$staticBottomContainerCards]}),$allStaticCards.forEach(e=>{utilsPizza.resetPizzaCard({pizzaCardElem:e,sizeValue:22,pizzaQuantity:1,callbackFormat:utilsFormat.formatPrice}),utilsPizza.updateBtn({parentElement:e,pizzaQuantity:1})})):(utilsDOM.removeClassFromAll({className:"d-none",arrElements:[$topContainerCards,$bottomContainerCards]}),utilsDOM.addClassToAll({className:"d-none",arrElements:[$staticTopContainerCards,$staticBottomContainerCards]}),utilsDOM.clearContainer($topContainerCards),utilsDOM.clearContainer($bottomContainerCards),e=pizzaProducts[t].slice(0,4),t=pizzaProducts[t].slice(4),e.length&&(e=utilsRender.renderAllCards(e,utilsFormat.formatPrice),$topContainerCards.innerHTML=""+e.join("")),t.length&&(e=utilsRender.renderAllCards(t,utilsFormat.formatPrice),$bottomContainerCards.innerHTML=""+e.join(""))))}),$menuOverlay.addEventListener("click",e=>{if(!e.target.closest(".menu__panel")||e.target.closest("#custom-panel-close"))$menuOverlay.close();else{var a=popUpPizzaData.pizzaData.size,t=popUpPizzaData.pizzaData.customPizza.id;if(e.target.closest(".panel-pizza__btn-quantity"))e.target.classList.contains("increment-quantity")?++popUpPizzaData.pizzaData.customQuantity:--popUpPizzaData.pizzaData.customQuantity,(popUpPizzaData.pizzaData.customQuantity>=MAX_PIZZA-1||popUpPizzaData.pizzaData.customQuantity<=2)&&(utilsPizza.updateBtn({parentElement:popUpPizzaData.cardElement,pizzaQuantity:popUpPizzaData.pizzaData.customQuantity}),utilsPizza.updateBtn({parentElement:$pizzaInfoPanel,pizzaQuantity:popUpPizzaData.pizzaData.customQuantity})),utilsPizza.setPizzaQuantity({parentElement:$pizzaInfoPanel,quantity:popUpPizzaData.pizzaData.customQuantity,selector:".quantity"}),utilsPizza.setPizzaQuantity({parentElement:popUpPizzaData.cardElement,quantity:popUpPizzaData.pizzaData.customQuantity,selector:".quantity"}),i=popUpPizzaData.pizzaData.customPizza.price[popUpPizzaData.pizzaData.size],i=utilsFormat.formatPrice(popUpPizzaData.pizzaData.customQuantity*i),utilsPizza.setPricePizza({parentElement:$pizzaInfoPanel,price:i,selector:".total-price"}),utilsPizza.setPricePizza({parentElement:popUpPizzaData.cardElement,price:i,selector:".total-price"});else{var i=e.target.closest(".panel-ingredients__value");if(i){var n=document.getElementById("custom-ingredients");let t=+i.getAttribute("data-id");var r=flatIngredients.find(e=>e.id===t),s=r.name,r=r.price*INGR_PRICE_COEFF[a],c=(i.classList.toggle("panel-ingredients__value--add"),i.classList.contains("panel-ingredients__value--add")),c=(i.setAttribute("aria-checked",c),c?(popUpPizzaData.pizzaData.customPizza.price[a]=popUpPizzaData.pizzaData.customPizza.price[a]+r,popUpPizzaData.pizzaData.customPizza.ingredients=[...popUpPizzaData.pizzaData.customPizza.ingredients,s],addedIngredients.push(flatIngredients.find(e=>e.id===t))):(popUpPizzaData.pizzaData.customPizza.price[a]=popUpPizzaData.pizzaData.customPizza.price[a]-r,-1!==(i=addedIngredients.findIndex(e=>e.id===t))&&addedIngredients.splice(i,1)),n.innerHTML=utilsRender.renderTextIngredients(addedIngredients.map(e=>e.name),"-"),utilsFormat.formatPrice(popUpPizzaData.pizzaData.customPizza.price[popUpPizzaData.pizzaData.size])),s=utilsFormat.formatPrice(popUpPizzaData.pizzaData.customQuantity*c);utilsPizza.setPricePizza({parentElement:$pizzaInfoPanel,price:s,selector:".total-price"}),utilsPizza.setPricePizza({parentElement:$pizzaInfoPanel,price:c,selector:".custom-price-one"}),void utilsPizza.setPricePizza({parentElement:popUpPizzaData.cardElement,price:s,selector:".total-price"})}else e.target.closest(".menu__panel-btn")&&(r=addedIngredients.map(e=>e.id).sort((e,t)=>e-t).join("-")||KEY.NO_INGREDIENTS,addToCart({cart:cart,idPizza:t,sizePizza:a,keyIngredients:r,pizzaQuantity:popUpPizzaData.pizzaData.customQuantity,pricePerPizza:popUpPizzaData.pizzaData.customPizza.price[a],namePizza:popUpPizzaData.pizzaData.customPizza.namePizza,image:popUpPizzaData.pizzaData.customPizza.image,separator:KEY.SEPARATOR,addedIngredients:addedIngredients}),utilsStorage.saveCart(cart),alert("Pizza added to cart"),utilsCart.updateCartItemCount({targetElement:$countCart,quantity:utilsCart.getQuantity({cart:cart,propertyQuantity:"pizzaQuantity"}),activeClass:"cart-btn__count--active"}),$menuOverlay.close())}}}),$menuOverlay.addEventListener("keydown",e=>{var t;"Enter"!==e.key&&" "!==e.key||(t=e.target.closest(".panel-ingredients__value"))&&(e.preventDefault(),t.click())}),$menuOverlay.addEventListener("close",e=>{console.log("CLOSE POP UP"),cleanupPizzaPopup({pizzaCardElem:popUpPizzaData.cardElement,sizeValue:popUpPizzaData.pizzaData.size,pizzaQuantity:popUpPizzaData.pizzaData.defaultQuantity,callbackFormat:utilsFormat.formatPrice}),popUpPizzaData={}}),$menuPizza.addEventListener("click",e=>{if(e.target.closest(".pizza-card__customize-btn")){var a=e.target.closest(".pizza-card"),i=a.querySelector(".pizza-card__form");if($activeCustomizeTrigger=e.target.closest(".pizza-card__customize-btn"),a&&i){let t=utilsPizza.getPizzaId(a);var e=utilsPizza.getPizzaSize(i),i=utilsPizza.getPizzaQuantity(a),n=flatPizzaProducts.find(e=>e.id===t),r=utilsData.deepClone(n),r=(popUpPizzaData={pizzaData:{defaultPizza:n,customPizza:r,size:e,customQuantity:i,defaultQuantity:i},cardElement:a},{});r.meats=utilsRender.renderCardsIngredients(ingredients.meats,INGR_PRICE_COEFF[e]),r.cheeses=utilsRender.renderCardsIngredients(ingredients.cheeses,INGR_PRICE_COEFF[e]),r.seafood=utilsRender.renderCardsIngredients(ingredients.seafood,INGR_PRICE_COEFF[e]),utilsRender.renderPanelAddIngredients(r,$ingredientsPanel),utilsRender.renderPanelInfoPizza({pizzaData:n,sizePizza:e,pizzaQuantity:i,container:$pizzaInfoPanel,callbackFormat:utilsFormat.formatPrice}),utilsPizza.updateBtn({parentElement:$pizzaInfoPanel,pizzaQuantity:popUpPizzaData.pizzaData.customQuantity}),utilsDOM.lockScroll(),$activeCustomizeTrigger.setAttribute("aria-expanded",!0),$menuOverlay.showModal()}}}),$menuPizza.addEventListener("click",e=>{if(e.target.closest(".pizza-card__order")){var e=e.target.closest(".pizza-card"),a=e.querySelector(".pizza-card__form");if(e&&a){let t=utilsPizza.getPizzaId(e);var i=flatPizzaProducts.find(e=>t===e.id),n=i.namePizza,r=utilsPizza.getPizzaQuantity(e),a=utilsPizza.getPizzaSize(a),s=i.price[a];addToCart({cart:cart,idPizza:t,sizePizza:a,keyIngredients:KEY.NO_INGREDIENTS,pizzaQuantity:r,pricePerPizza:s,namePizza:n,image:i.image,separator:KEY.SEPARATOR}),utilsCart.updateCartItemCount({targetElement:$countCart,quantity:utilsCart.getQuantity({cart:cart,propertyQuantity:"pizzaQuantity"}),activeClass:"cart-btn__count--active"}),utilsPizza.resetPizzaCard({pizzaCardElem:e,sizeValue:22,pizzaQuantity:1,callbackFormat:utilsFormat.formatPrice}),utilsStorage.saveCart(cart),alert("Pizza added to cart")}}}),$menuPizza.addEventListener("click",t=>{if(t.target.closest(".pizza-card__quantity-btn")){var a=t.target.closest(".pizza-card"),i=a.querySelector(".pizza-card__form");if(a&&i){let e=utilsPizza.getPizzaQuantity(a);i=utilsPizza.getPricePerPizza(i),t=(t.target.closest(".increment-quantity")?++e:t.target.closest(".decrement-quantity")&&--e,(e>=MAX_PIZZA-1||e<=2)&&utilsPizza.updateBtn({parentElement:a,pizzaQuantity:e}),utilsFormat.formatPrice(e*i));utilsPizza.setPricePizza({parentElement:a,price:t,selector:".total-price"}),utilsPizza.setPizzaQuantity({parentElement:a,quantity:e,selector:".quantity"})}}}),$menuPizza.addEventListener("change",e=>{var t,a;e.target.closest(".pizza-card__size-radio")&&(t=(e=e.target.closest(".pizza-card")).querySelector(".pizza-card__form"),e)&&t&&(a=utilsPizza.getPizzaQuantity(e),t=utilsPizza.getPricePerPizza(t),a=utilsFormat.formatPrice(a*t),utilsPizza.setPricePizza({parentElement:e,price:a,selector:".total-price"}))});let $eventsTexts=document.querySelectorAll(".event__text"),$eventsTitles=document.querySelectorAll(".event__title"),$header=(utilsDOM.hiddenText($eventsTitles[5],25),document.querySelector(".header")),$aside=(window.addEventListener("scroll",e=>{60<window.scrollY?$header.classList.add("header--active"):$header.classList.remove("header--active")},{passive:!0}),document.getElementById("modal-aside")),$asideTitle=document.getElementById("aside-title"),$containerItems=document.getElementById("items-cart"),$totalItemsPrice=document.getElementById("total-items-price"),$formOrder=document.getElementById("form-order"),$inputTel=$formOrder.user_tel,$btnFooterCart=document.getElementById("btn-footer-cart"),renderCartPanel=()=>{var e=Object.entries(cart);e.length?renderCartWithItems(e):renderEmptyCart()},renderEmptyCart=()=>{$containerItems.innerHTML=`
    <div class="empty-cart">
      <p>ðŸ›’ Cart is empty</p>
      <p>Fill the form and we'll call you back</p>
      <p>Or add pizzas to order</p>
    </div>
  `,setCartPanelTexts("Get a call","Request a call")},renderCartWithItems=e=>{$containerItems.innerHTML=e.map(e=>utilsRender.renderCartItem(e)).join(""),setCartPanelTexts("Order details","Order with call")},setCartPanelTexts=(e,t)=>{$asideTitle.textContent=e,$btnFooterCart.textContent=t};function createOrder({totalItemsPrice:e,cart:t,tel:a}){var i=["Order call","Order pizza"];let n="Order call";var r="ORD-"+Date.now();let s=null;var t=Object.values(t);return s=t.length?(n=i[1],console.log(t,n,a),t=t.map(e=>{var t=e.addedIngredients.length?e.addedIngredients.map(e=>e.name.toUpperCase()).join(", "):"no additional ingredients";return{"Name pizza":e.namePizza,Quantity:e.pizzaQuantity,Size:e.sizePizza+"ÑÐ¼","Additional ingredients":t,"Total price pizza":e.totalPrice+" $"}}),{"Order ID":r,Type:n,orders:t,"Phone client":a,"Total price orders":e}):{"Order ID":r,Type:n=i[0],"Phone client":a}}$cartBtn.addEventListener("click",e=>{$aside.classList.add("aside--active"),utilsDOM.lockScroll(),renderCartPanel(),$totalItemsPrice.textContent=utilsCart.sumCartItemsPrice({cart:cart}).toFixed(2)+" $"}),$aside.addEventListener("click",async e=>{if(console.log("aside click"),e.target.closest(".aside__panel")&&!e.target.closest("#aside-close")||($aside.classList.remove("aside--active"),utilsDOM.unlockScroll()),e.target.closest(".cart-item__btn")){var t=e.target.closest(".cart-item").getAttribute("data-id");if(e.target.classList.contains("cart-item__remove"))return delete cart[t],utilsStorage.saveCart(cart),renderCartPanel(),$totalItemsPrice.textContent=utilsCart.sumCartItemsPrice({cart:cart}).toFixed(2)+" $",void utilsCart.updateCartItemCount({targetElement:$countCart,quantity:utilsCart.getQuantity({cart:cart,propertyQuantity:"pizzaQuantity"}),activeClass:"cart-btn__count--active"});if(e.target.classList.contains("cart-item__btn--minus")&&1<cart[t].pizzaQuantity)return--cart[t].pizzaQuantity,utilsCart.calculateItemTotalPrice({cart:cart,idCartItem:t}),utilsStorage.saveCart(cart),renderCartPanel(),$totalItemsPrice.textContent=utilsCart.sumCartItemsPrice({cart:cart}).toFixed(2)+" $",void utilsCart.updateCartItemCount({targetElement:$countCart,quantity:utilsCart.getQuantity({cart:cart,propertyQuantity:"pizzaQuantity"}),activeClass:"cart-btn__count--active"});if(e.target.classList.contains("cart-item__btn--plus"))return++cart[t].pizzaQuantity,utilsCart.calculateItemTotalPrice({cart:cart,idCartItem:t}),utilsStorage.saveCart(cart),renderCartPanel(),$totalItemsPrice.textContent=utilsCart.sumCartItemsPrice({cart:cart}).toFixed(2)+" $",void utilsCart.updateCartItemCount({targetElement:$countCart,quantity:utilsCart.getQuantity({cart:cart,propertyQuantity:"pizzaQuantity"}),activeClass:"cart-btn__count--active"})}if(e.target.closest("#btn-footer-cart")){if(!$inputTel.checkValidity())return $inputTel.reportValidity(),!1;t=createOrder({totalItemsPrice:$totalItemsPrice.textContent,cart:cart,tel:$inputTel.value});cart={},utilsStorage.saveCart(cart),$formOrder.reset(),renderEmptyCart(),$totalItemsPrice.textContent="0.00 $",$countCart.classList.remove("cart-btn__count--active"),$countCart.textContent=0,alert("Your order has been sent! We'll call you back.");e=await(await fetch("/send-form.php",{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify(t)})).json();alert(e.message)}});